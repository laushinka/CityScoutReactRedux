Object.defineProperty(exports,"__esModule",{value:true});var _last2=require("lodash/last");var _last3=_interopRequireDefault(_last2);var _assign2=require("lodash/assign");var _assign3=_interopRequireDefault(_assign2);
var _victoryCore=require("victory-core");
var _data=require("../../helpers/data");var _data2=_interopRequireDefault(_data);
var _domain=require("../../helpers/domain");var _domain2=_interopRequireDefault(_domain);
var _scale=require("../../helpers/scale");var _scale2=_interopRequireDefault(_scale);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i];}return arr2;}else{return Array.from(arr);}}exports.default=

{

getBaseProps:function getBaseProps(props,fallbackProps){
var modifiedProps=_victoryCore.Helpers.modifyProps(props,fallbackProps);var _getCalculatedValues=
this.getCalculatedValues(modifiedProps,fallbackProps);var scale=_getCalculatedValues.scale;var style=_getCalculatedValues.style;var data=_getCalculatedValues.data;var
interpolation=modifiedProps.interpolation;var label=modifiedProps.label;var width=modifiedProps.width;var height=modifiedProps.height;var groupComponent=modifiedProps.groupComponent;

var dataProps={
groupComponent:groupComponent,
key:"area",
data:data,
scale:scale,
interpolation:_victoryCore.Helpers.evaluateProp(interpolation,data),
style:_victoryCore.Helpers.evaluateStyle(style.data,data)};


var text=_victoryCore.Helpers.evaluateProp(label,data);
var lastData=(0,_last3.default)(data);
var labelStyle=_victoryCore.Helpers.evaluateStyle(style.labels,data);

var labelProps={
key:"area-label",
x:lastData?scale.x(lastData.x)+labelStyle.padding:0,
y:lastData?scale.y(lastData.y1):0,
y0:lastData?scale.y(lastData.y0):0,
style:labelStyle,
textAnchor:labelStyle.textAnchor||"start",
verticalAnchor:labelStyle.verticalAnchor||"middle",
angle:labelStyle.angle,
data:data,
scale:scale,
text:text};


return{
parent:{style:style.parent,width:width,height:height,scale:scale,data:data},
all:{
data:dataProps,
labels:labelProps}};


},

getScale:function getScale(props,fallbackProps){
if(fallbackProps){
props=_victoryCore.Helpers.modifyProps(props,fallbackProps);
}
var range={
x:_victoryCore.Helpers.getRange(props,"x"),
y:_victoryCore.Helpers.getRange(props,"y")};

var domain={
x:_domain2.default.getDomainWithZero(props,"x"),
y:_domain2.default.getDomainWithZero(props,"y")};

var scale={
x:_scale2.default.getBaseScale(props,"x").domain(domain.x).range(range.x),
y:_scale2.default.getBaseScale(props,"y").domain(domain.y).range(range.y)};


return{scale:scale,domain:domain};
},

getCalculatedValues:function getCalculatedValues(props,fallbackProps){
var defaultStyles=props.theme&&props.theme.area?props.theme.area:
fallbackProps.style;
var style=_victoryCore.Helpers.getStyles(props.style,defaultStyles,"auto","100%");var _getScale=
this.getScale(props);var scale=_getScale.scale;var domain=_getScale.domain;

var data=this.getDataWithBaseline(props,domain);
return{style:style,data:data,scale:scale};
},

getDataWithBaseline:function getDataWithBaseline(props,domain){
var data=_data2.default.getData(props);

if(data.length<2){
_victoryCore.Log.warn("Area requires at least two data points.");
data=[];
}

var defaultMin=_scale2.default.getScaleType(props,"y")==="log"?1/Number.MAX_SAFE_INTEGER:0;
var minY=Math.min.apply(Math,_toConsumableArray(domain.y))>0?Math.min.apply(Math,_toConsumableArray(domain.y)):defaultMin;

return data.map(function(datum){
var y1=datum.yOffset?datum.yOffset+datum.y:datum.y;
var y0=datum.yOffset||minY;
return(0,_assign3.default)({y0:y0,y1:y1},datum);
});
}};